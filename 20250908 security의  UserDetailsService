/* security에서 사용자의 아이디를 인증하기 위한 인터페이스이다.
 *  loadUserByUsername을 필수로 구현해야 하며 로그인 인증 시 해당 메소드에
 *  login 요청 시 전달된 사용자의 id를 매개변수로 DB에서 조회한다.
 * */


//스프링 컴포넌트 등록용 애너테이션.이 클래스를 서비스 빈으로 스캔해서 IoC 컨테이너에 올려둔다. 다른 곳에서 주입 받아 씀.
@Service
public class AuthService implements UserDetailsService {

   // UserService를 **의존성 주입(DI)**으로 가져와. 이게 실제로 DB/레포지토리에서 유저를 조회해줄 애.
    @Autowired
    private UserService userService;

    @Override
    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {

        LoginUserDTO login = userService.findByUsername(username);

        if(Objects.isNull(login)) {
            throw new UsernameNotFoundException("해당하는 회원 정보가 존재하지 않습니다.");
        }

        return new AuthDetails(login);
    }
}
